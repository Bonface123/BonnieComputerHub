// Tiny confetti animation (uses canvas)
(function(){
  if (window.confetti) return;
  window.confetti = function(){
    var duration = 1.2 * 1000;
    var animationEnd = Date.now() + duration;
    var defaults = {startVelocity: 30, spread: 360, ticks: 60, zIndex: 9999};
    function randomInRange(min, max) { return Math.random() * (max - min) + min; }
    var colors = ['#FFD700', '#1E40AF', '#fff', '#22d3ee', '#fbbf24'];
    var interval = setInterval(function() {
      var timeLeft = animationEnd - Date.now();
      if (timeLeft <= 0) return clearInterval(interval);
      var particleCount = 40 * (timeLeft / duration);
      confettiImpl({
        particleCount: particleCount,
        angle: randomInRange(55, 125),
        spread: randomInRange(50, 70),
        origin: { y: 0.6 },
        colors: colors
      });
    }, 200);
    function confettiImpl(opts){
      var canvas = document.getElementById('bch-confetti');
      if (!canvas) {
        canvas = document.createElement('canvas');
        canvas.id = 'bch-confetti';
        canvas.style.position = 'fixed';
        canvas.style.top = 0;
        canvas.style.left = 0;
        canvas.style.width = '100vw';
        canvas.style.height = '100vh';
        canvas.style.pointerEvents = 'none';
        canvas.style.zIndex = 9999;
        document.body.appendChild(canvas);
      }
      var ctx = canvas.getContext('2d');
      var w = window.innerWidth, h = window.innerHeight;
      canvas.width = w; canvas.height = h;
      for (var i = 0; i < opts.particleCount; i++) {
        ctx.beginPath();
        ctx.arc(Math.random()*w, Math.random()*h, Math.random()*8+2, 0, 2*Math.PI);
        ctx.fillStyle = opts.colors[Math.floor(Math.random()*opts.colors.length)];
        ctx.globalAlpha = 0.7;
        ctx.fill();
      }
      setTimeout(function(){ ctx.clearRect(0,0,w,h); }, 700);
    }
  };
})();
